<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Configuracion de drive (para guardar los resultados) | fastpages</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Configuracion de drive (para guardar los resultados)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<meta property="og:description" content="An easy to use blogging platform with support for Jupyter Notebooks." />
<link rel="canonical" href="https://aljusa.github.io/lowhaningmolecules/2021/06/21/docking.html" />
<meta property="og:url" content="https://aljusa.github.io/lowhaningmolecules/2021/06/21/docking.html" />
<meta property="og:site_name" content="fastpages" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-06-21T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"An easy to use blogging platform with support for Jupyter Notebooks.","url":"https://aljusa.github.io/lowhaningmolecules/2021/06/21/docking.html","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://aljusa.github.io/lowhaningmolecules/2021/06/21/docking.html"},"headline":"Configuracion de drive (para guardar los resultados)","dateModified":"2021-06-21T00:00:00-05:00","datePublished":"2021-06-21T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/lowhaningmolecules/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://aljusa.github.io/lowhaningmolecules/feed.xml" title="fastpages" /><link rel="shortcut icon" type="image/x-icon" href="/lowhaningmolecules/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/lowhaningmolecules/">fastpages</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/lowhaningmolecules/about/">About Me</a><a class="page-link" href="/lowhaningmolecules/search/">Search</a><a class="page-link" href="/lowhaningmolecules/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Configuracion de drive (para guardar los resultados)</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2021-06-21T00:00:00-05:00" itemprop="datePublished">
        Jun 21, 2021
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      25 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/aljusa/lowhaningmolecules/tree/master/_notebooks/2021-06-21-docking.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/lowhaningmolecules/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/aljusa/lowhaningmolecules/master?filepath=_notebooks%2F2021-06-21-docking.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/lowhaningmolecules/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/aljusa/lowhaningmolecules/blob/master/_notebooks/2021-06-21-docking.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/lowhaningmolecules/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-06-21-docking.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/gdrive&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Mounted at /content/gdrive
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Configuracion-de-programas">Configuracion de programas<a class="anchor-link" href="#Configuracion-de-programas"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">wget</span> <span class="o">-</span><span class="n">c</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">repo</span><span class="o">.</span><span class="n">continuum</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">miniconda</span><span class="o">/</span><span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="err">!</span><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span>
<span class="err">!</span><span class="n">bash</span> <span class="o">./</span><span class="n">Miniconda3</span><span class="o">-</span><span class="n">latest</span><span class="o">-</span><span class="n">Linux</span><span class="o">-</span><span class="n">x86_64</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">b</span> <span class="o">-</span><span class="n">f</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span>
<span class="err">!</span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">q</span> <span class="n">python</span><span class="o">=</span><span class="mf">3.7</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/usr/local/lib/python3.7/site-packages/&#39;</span><span class="p">)</span>

<span class="c1">#rdkit</span>
<span class="err">!</span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">rdkit</span>

<span class="c1">#py3dmol</span>
<span class="err">!</span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">py3dmol</span>
<span class="kn">import</span> <span class="nn">py3Dmol</span>

<span class="c1">#openbabel</span>
<span class="err">!</span><span class="n">apt</span> <span class="n">install</span> <span class="n">openbabel</span>
<span class="err">!</span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">openbabel</span>

<span class="c1">#pymol</span>
<span class="err">!</span><span class="n">apt</span> <span class="n">install</span> <span class="n">pymol</span> 

<span class="c1">#smina</span>
<span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">downloads</span><span class="o">.</span><span class="n">sourceforge</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">project</span><span class="o">/</span><span class="n">smina</span><span class="o">/</span><span class="n">smina</span><span class="o">.</span><span class="n">static</span>
<span class="err">!</span><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">smina</span><span class="o">.</span><span class="n">static</span>

<span class="c1">#gnina</span>
<span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gnina</span><span class="o">/</span><span class="n">gnina</span><span class="o">/</span><span class="n">releases</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="n">v1</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">gnina</span>
<span class="err">!</span><span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="n">gnina</span>

<span class="c1">#plip</span>
<span class="err">!</span><span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">c</span> <span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">plip</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--2021-06-18 15:16:55--  https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
Resolving repo.continuum.io (repo.continuum.io)... 104.18.200.79, 104.18.201.79, 2606:4700::6812:c94f, ...
Connecting to repo.continuum.io (repo.continuum.io)|104.18.200.79|:443... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh [following]
--2021-06-18 15:16:55--  https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
Resolving repo.anaconda.com (repo.anaconda.com)... 104.16.131.3, 104.16.130.3, 2606:4700::6810:8203, ...
Connecting to repo.anaconda.com (repo.anaconda.com)|104.16.131.3|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 94235922 (90M) [application/x-sh]
Saving to: â€˜Miniconda3-latest-Linux-x86_64.shâ€™

Miniconda3-latest-L 100%[===================&gt;]  89.87M   154MB/s    in 0.6s    

2021-06-18 15:16:55 (154 MB/s) - â€˜Miniconda3-latest-Linux-x86_64.shâ€™ saved [94235922/94235922]

PREFIX=/usr/local
Unpacking payload ...
Collecting package metadata (current_repodata.json): - \ | done
Solving environment: - \ done

## Package Plan ##

  environment location: /usr/local

  added / updated specs:
    - _libgcc_mutex==0.1=main
    - brotlipy==0.7.0=py38h27cfd23_1003
    - ca-certificates==2020.10.14=0
    - certifi==2020.6.20=pyhd3eb1b0_3
    - cffi==1.14.3=py38h261ae71_2
    - chardet==3.0.4=py38h06a4308_1003
    - conda-package-handling==1.7.2=py38h03888b9_0
    - conda==4.9.2=py38h06a4308_0
    - cryptography==3.2.1=py38h3c74f83_1
    - idna==2.10=py_0
    - ld_impl_linux-64==2.33.1=h53a641e_7
    - libedit==3.1.20191231=h14c3975_1
    - libffi==3.3=he6710b0_2
    - libgcc-ng==9.1.0=hdf63c60_0
    - libstdcxx-ng==9.1.0=hdf63c60_0
    - ncurses==6.2=he6710b0_1
    - openssl==1.1.1h=h7b6447c_0
    - pip==20.2.4=py38h06a4308_0
    - pycosat==0.6.3=py38h7b6447c_1
    - pycparser==2.20=py_2
    - pyopenssl==19.1.0=pyhd3eb1b0_1
    - pysocks==1.7.1=py38h06a4308_0
    - python==3.8.5=h7579374_1
    - readline==8.0=h7b6447c_0
    - requests==2.24.0=py_0
    - ruamel_yaml==0.15.87=py38h7b6447c_1
    - setuptools==50.3.1=py38h06a4308_1
    - six==1.15.0=py38h06a4308_0
    - sqlite==3.33.0=h62c20be_0
    - tk==8.6.10=hbc83047_0
    - tqdm==4.51.0=pyhd3eb1b0_0
    - urllib3==1.25.11=py_0
    - wheel==0.35.1=pyhd3eb1b0_0
    - xz==5.2.5=h7b6447c_0
    - yaml==0.2.5=h7b6447c_0
    - zlib==1.2.11=h7b6447c_3


The following NEW packages will be INSTALLED:

  _libgcc_mutex      pkgs/main/linux-64::_libgcc_mutex-0.1-main
  brotlipy           pkgs/main/linux-64::brotlipy-0.7.0-py38h27cfd23_1003
  ca-certificates    pkgs/main/linux-64::ca-certificates-2020.10.14-0
  certifi            pkgs/main/noarch::certifi-2020.6.20-pyhd3eb1b0_3
  cffi               pkgs/main/linux-64::cffi-1.14.3-py38h261ae71_2
  chardet            pkgs/main/linux-64::chardet-3.0.4-py38h06a4308_1003
  conda              pkgs/main/linux-64::conda-4.9.2-py38h06a4308_0
  conda-package-han~ pkgs/main/linux-64::conda-package-handling-1.7.2-py38h03888b9_0
  cryptography       pkgs/main/linux-64::cryptography-3.2.1-py38h3c74f83_1
  idna               pkgs/main/noarch::idna-2.10-py_0
  ld_impl_linux-64   pkgs/main/linux-64::ld_impl_linux-64-2.33.1-h53a641e_7
  libedit            pkgs/main/linux-64::libedit-3.1.20191231-h14c3975_1
  libffi             pkgs/main/linux-64::libffi-3.3-he6710b0_2
  libgcc-ng          pkgs/main/linux-64::libgcc-ng-9.1.0-hdf63c60_0
  libstdcxx-ng       pkgs/main/linux-64::libstdcxx-ng-9.1.0-hdf63c60_0
  ncurses            pkgs/main/linux-64::ncurses-6.2-he6710b0_1
  openssl            pkgs/main/linux-64::openssl-1.1.1h-h7b6447c_0
  pip                pkgs/main/linux-64::pip-20.2.4-py38h06a4308_0
  pycosat            pkgs/main/linux-64::pycosat-0.6.3-py38h7b6447c_1
  pycparser          pkgs/main/noarch::pycparser-2.20-py_2
  pyopenssl          pkgs/main/noarch::pyopenssl-19.1.0-pyhd3eb1b0_1
  pysocks            pkgs/main/linux-64::pysocks-1.7.1-py38h06a4308_0
  python             pkgs/main/linux-64::python-3.8.5-h7579374_1
  readline           pkgs/main/linux-64::readline-8.0-h7b6447c_0
  requests           pkgs/main/noarch::requests-2.24.0-py_0
  ruamel_yaml        pkgs/main/linux-64::ruamel_yaml-0.15.87-py38h7b6447c_1
  setuptools         pkgs/main/linux-64::setuptools-50.3.1-py38h06a4308_1
  six                pkgs/main/linux-64::six-1.15.0-py38h06a4308_0
  sqlite             pkgs/main/linux-64::sqlite-3.33.0-h62c20be_0
  tk                 pkgs/main/linux-64::tk-8.6.10-hbc83047_0
  tqdm               pkgs/main/noarch::tqdm-4.51.0-pyhd3eb1b0_0
  urllib3            pkgs/main/noarch::urllib3-1.25.11-py_0
  wheel              pkgs/main/noarch::wheel-0.35.1-pyhd3eb1b0_0
  xz                 pkgs/main/linux-64::xz-5.2.5-h7b6447c_0
  yaml               pkgs/main/linux-64::yaml-0.2.5-h7b6447c_0
  zlib               pkgs/main/linux-64::zlib-1.2.11-h7b6447c_3


Preparing transaction: / - \ done
Executing transaction: / - \ | / - \ | / - \ done
installation finished.
WARNING:
    You currently have a PYTHONPATH environment variable set. This may cause
    unexpected behavior when running the Python interpreter in Miniconda3.
    For best results, please verify that your PYTHONPATH only points to
    directories of packages that are compatible with the Python interpreter
    in Miniconda3: /usr/local
Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /usr/local

  added / updated specs:
    - python=3.7


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    brotlipy-0.7.0             |py37h27cfd23_1003         320 KB
    ca-certificates-2021.5.25  |       h06a4308_1         112 KB
    certifi-2021.5.30          |   py37h06a4308_0         139 KB
    cffi-1.14.5                |   py37h261ae71_0         224 KB
    chardet-3.0.4              |py37h06a4308_1003         175 KB
    conda-4.10.1               |   py37h06a4308_1         2.9 MB
    conda-package-handling-1.7.3|   py37h27cfd23_1         881 KB
    cryptography-3.4.7         |   py37hd23ed53_0         904 KB
    openssl-1.1.1k             |       h27cfd23_0         2.5 MB
    pip-21.1.2                 |   py37h06a4308_0         1.8 MB
    pycosat-0.6.3              |   py37h27cfd23_0          81 KB
    pysocks-1.7.1              |           py37_1          27 KB
    python-3.7.10              |       hdb3f193_0        45.2 MB
    ruamel_yaml-0.15.100       |   py37h27cfd23_0         253 KB
    setuptools-52.0.0          |   py37h06a4308_0         710 KB
    six-1.16.0                 |     pyhd3eb1b0_0          18 KB
    ------------------------------------------------------------
                                           Total:        56.1 MB

The following packages will be UPDATED:

  ca-certificates                              2020.10.14-0 --&gt; 2021.5.25-h06a4308_1
  certifi            pkgs/main/noarch::certifi-2020.6.20-p~ --&gt; pkgs/main/linux-64::certifi-2021.5.30-py37h06a4308_0
  cffi                                1.14.3-py38h261ae71_2 --&gt; 1.14.5-py37h261ae71_0
  conda                                4.9.2-py38h06a4308_0 --&gt; 4.10.1-py37h06a4308_1
  conda-package-han~                   1.7.2-py38h03888b9_0 --&gt; 1.7.3-py37h27cfd23_1
  cryptography                         3.2.1-py38h3c74f83_1 --&gt; 3.4.7-py37hd23ed53_0
  openssl                                 1.1.1h-h7b6447c_0 --&gt; 1.1.1k-h27cfd23_0
  pip                                 20.2.4-py38h06a4308_0 --&gt; 21.1.2-py37h06a4308_0
  pysocks                              1.7.1-py38h06a4308_0 --&gt; 1.7.1-py37_1
  ruamel_yaml                        0.15.87-py38h7b6447c_1 --&gt; 0.15.100-py37h27cfd23_0
  setuptools                          50.3.1-py38h06a4308_1 --&gt; 52.0.0-py37h06a4308_0
  six                pkgs/main/linux-64::six-1.15.0-py38h0~ --&gt; pkgs/main/noarch::six-1.16.0-pyhd3eb1b0_0

The following packages will be DOWNGRADED:

  brotlipy                          0.7.0-py38h27cfd23_1003 --&gt; 0.7.0-py37h27cfd23_1003
  chardet                           3.0.4-py38h06a4308_1003 --&gt; 3.0.4-py37h06a4308_1003
  pycosat                              0.6.3-py38h7b6447c_1 --&gt; 0.6.3-py37h27cfd23_0
  python                                   3.8.5-h7579374_1 --&gt; 3.7.10-hdb3f193_0


Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /usr/local

  added / updated specs:
    - rdkit


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    _openmp_mutex-4.5          |            1_gnu          22 KB
    boost-1.74.0               |   py37h6dcda5c_3         342 KB  conda-forge
    boost-cpp-1.74.0           |       h312852a_4        16.3 MB  conda-forge
    bzip2-1.0.8                |       h7f98852_4         484 KB  conda-forge
    ca-certificates-2021.5.30  |       ha878542_0         136 KB  conda-forge
    cairo-1.16.0               |    h6cf1ce9_1008         1.5 MB  conda-forge
    certifi-2021.5.30          |   py37h89c1867_0         141 KB  conda-forge
    conda-4.10.1               |   py37h89c1867_0         3.1 MB  conda-forge
    cycler-0.10.0              |             py_2           9 KB  conda-forge
    fontconfig-2.13.1          |    hba837de_1005         357 KB  conda-forge
    freetype-2.10.4            |       h0708190_1         890 KB  conda-forge
    gettext-0.19.8.1           |    h0b5b191_1005         3.6 MB  conda-forge
    greenlet-1.1.0             |   py37hcd2ae1e_0          83 KB  conda-forge
    icu-68.1                   |       h58526e2_0        13.0 MB  conda-forge
    importlib-metadata-4.5.0   |   py37h89c1867_0          31 KB  conda-forge
    jbig-2.1                   |    h7f98852_2003          43 KB  conda-forge
    jpeg-9d                    |       h36c2ea0_0         264 KB  conda-forge
    kiwisolver-1.3.1           |   py37h2527ec5_1          78 KB  conda-forge
    lcms2-2.12                 |       hddcbb42_0         443 KB  conda-forge
    lerc-2.2.1                 |       h9c3ff4c_0         213 KB  conda-forge
    libblas-3.9.0              |       9_openblas          11 KB  conda-forge
    libcblas-3.9.0             |       9_openblas          11 KB  conda-forge
    libdeflate-1.7             |       h7f98852_5          67 KB  conda-forge
    libgcc-ng-9.3.0            |      h5101ec6_17         4.8 MB
    libgfortran-ng-9.3.0       |      hff62375_19          22 KB  conda-forge
    libgfortran5-9.3.0         |      hff62375_19         2.0 MB  conda-forge
    libglib-2.68.3             |       h3e27bee_0         3.1 MB  conda-forge
    libgomp-9.3.0              |      h5101ec6_17         311 KB
    libiconv-1.16              |       h516909a_0         1.4 MB  conda-forge
    liblapack-3.9.0            |       9_openblas          11 KB  conda-forge
    libopenblas-0.3.15         |pthreads_h8fe5266_1         9.2 MB  conda-forge
    libpng-1.6.37              |       h21135ba_2         306 KB  conda-forge
    libstdcxx-ng-9.3.0         |      h6de172a_19         4.0 MB  conda-forge
    libtiff-4.3.0              |       hf544144_1         668 KB  conda-forge
    libuuid-2.32.1             |    h7f98852_1000          28 KB  conda-forge
    libwebp-base-1.2.0         |       h7f98852_2         815 KB  conda-forge
    libxcb-1.13                |    h7f98852_1003         395 KB  conda-forge
    libxml2-2.9.12             |       h72842e0_0         772 KB  conda-forge
    lz4-c-1.9.3                |       h9c3ff4c_0         179 KB  conda-forge
    matplotlib-base-3.4.2      |   py37hdd32ed1_0         7.2 MB  conda-forge
    numpy-1.20.3               |   py37h038b26d_1         5.7 MB  conda-forge
    olefile-0.46               |     pyh9f0ad1d_1          32 KB  conda-forge
    openjpeg-2.4.0             |       hb52868f_1         444 KB  conda-forge
    openssl-1.1.1k             |       h7f98852_0         2.1 MB  conda-forge
    pandas-1.2.4               |   py37h219a48f_0        11.8 MB  conda-forge
    pcre-8.45                  |       h9c3ff4c_0         253 KB  conda-forge
    pillow-8.2.0               |   py37h4600e1f_1         684 KB  conda-forge
    pixman-0.40.0              |       h36c2ea0_0         627 KB  conda-forge
    pthread-stubs-0.4          |    h36c2ea0_1001           5 KB  conda-forge
    pycairo-1.20.1             |   py37hfff247e_0          77 KB  conda-forge
    pyparsing-2.4.7            |     pyh9f0ad1d_0          60 KB  conda-forge
    python-dateutil-2.8.1      |             py_0         220 KB  conda-forge
    python_abi-3.7             |          1_cp37m           4 KB  conda-forge
    pytz-2021.1                |     pyhd8ed1ab_0         239 KB  conda-forge
    rdkit-2021.03.3            |   py37haf5a968_0        38.4 MB  conda-forge
    reportlab-3.5.67           |   py37h69800bb_0         2.4 MB  conda-forge
    sqlalchemy-1.4.18          |   py37h5e8e339_0         2.2 MB  conda-forge
    tornado-6.1                |   py37h5e8e339_1         646 KB  conda-forge
    typing_extensions-3.10.0.0 |     pyha770c72_0          28 KB  conda-forge
    xorg-kbproto-1.0.7         |    h7f98852_1002          27 KB  conda-forge
    xorg-libice-1.0.10         |       h7f98852_0          58 KB  conda-forge
    xorg-libsm-1.2.3           |    hd9c2040_1000          26 KB  conda-forge
    xorg-libx11-1.7.2          |       h7f98852_0         941 KB  conda-forge
    xorg-libxau-1.0.9          |       h7f98852_0          13 KB  conda-forge
    xorg-libxdmcp-1.1.3        |       h7f98852_0          19 KB  conda-forge
    xorg-libxext-1.3.4         |       h7f98852_1          54 KB  conda-forge
    xorg-libxrender-0.9.10     |    h7f98852_1003          32 KB  conda-forge
    xorg-renderproto-0.11.1    |    h7f98852_1002           9 KB  conda-forge
    xorg-xextproto-7.3.0       |    h7f98852_1002          28 KB  conda-forge
    xorg-xproto-7.0.31         |    h7f98852_1007          73 KB  conda-forge
    zipp-3.4.1                 |     pyhd8ed1ab_0          11 KB  conda-forge
    zstd-1.5.0                 |       ha95c52a_0         490 KB  conda-forge
    ------------------------------------------------------------
                                           Total:       143.7 MB

The following NEW packages will be INSTALLED:

  _openmp_mutex      pkgs/main/linux-64::_openmp_mutex-4.5-1_gnu
  boost              conda-forge/linux-64::boost-1.74.0-py37h6dcda5c_3
  boost-cpp          conda-forge/linux-64::boost-cpp-1.74.0-h312852a_4
  bzip2              conda-forge/linux-64::bzip2-1.0.8-h7f98852_4
  cairo              conda-forge/linux-64::cairo-1.16.0-h6cf1ce9_1008
  cycler             conda-forge/noarch::cycler-0.10.0-py_2
  fontconfig         conda-forge/linux-64::fontconfig-2.13.1-hba837de_1005
  freetype           conda-forge/linux-64::freetype-2.10.4-h0708190_1
  gettext            conda-forge/linux-64::gettext-0.19.8.1-h0b5b191_1005
  greenlet           conda-forge/linux-64::greenlet-1.1.0-py37hcd2ae1e_0
  icu                conda-forge/linux-64::icu-68.1-h58526e2_0
  importlib-metadata conda-forge/linux-64::importlib-metadata-4.5.0-py37h89c1867_0
  jbig               conda-forge/linux-64::jbig-2.1-h7f98852_2003
  jpeg               conda-forge/linux-64::jpeg-9d-h36c2ea0_0
  kiwisolver         conda-forge/linux-64::kiwisolver-1.3.1-py37h2527ec5_1
  lcms2              conda-forge/linux-64::lcms2-2.12-hddcbb42_0
  lerc               conda-forge/linux-64::lerc-2.2.1-h9c3ff4c_0
  libblas            conda-forge/linux-64::libblas-3.9.0-9_openblas
  libcblas           conda-forge/linux-64::libcblas-3.9.0-9_openblas
  libdeflate         conda-forge/linux-64::libdeflate-1.7-h7f98852_5
  libgfortran-ng     conda-forge/linux-64::libgfortran-ng-9.3.0-hff62375_19
  libgfortran5       conda-forge/linux-64::libgfortran5-9.3.0-hff62375_19
  libglib            conda-forge/linux-64::libglib-2.68.3-h3e27bee_0
  libgomp            pkgs/main/linux-64::libgomp-9.3.0-h5101ec6_17
  libiconv           conda-forge/linux-64::libiconv-1.16-h516909a_0
  liblapack          conda-forge/linux-64::liblapack-3.9.0-9_openblas
  libopenblas        conda-forge/linux-64::libopenblas-0.3.15-pthreads_h8fe5266_1
  libpng             conda-forge/linux-64::libpng-1.6.37-h21135ba_2
  libtiff            conda-forge/linux-64::libtiff-4.3.0-hf544144_1
  libuuid            conda-forge/linux-64::libuuid-2.32.1-h7f98852_1000
  libwebp-base       conda-forge/linux-64::libwebp-base-1.2.0-h7f98852_2
  libxcb             conda-forge/linux-64::libxcb-1.13-h7f98852_1003
  libxml2            conda-forge/linux-64::libxml2-2.9.12-h72842e0_0
  lz4-c              conda-forge/linux-64::lz4-c-1.9.3-h9c3ff4c_0
  matplotlib-base    conda-forge/linux-64::matplotlib-base-3.4.2-py37hdd32ed1_0
  numpy              conda-forge/linux-64::numpy-1.20.3-py37h038b26d_1
  olefile            conda-forge/noarch::olefile-0.46-pyh9f0ad1d_1
  openjpeg           conda-forge/linux-64::openjpeg-2.4.0-hb52868f_1
  pandas             conda-forge/linux-64::pandas-1.2.4-py37h219a48f_0
  pcre               conda-forge/linux-64::pcre-8.45-h9c3ff4c_0
  pillow             conda-forge/linux-64::pillow-8.2.0-py37h4600e1f_1
  pixman             conda-forge/linux-64::pixman-0.40.0-h36c2ea0_0
  pthread-stubs      conda-forge/linux-64::pthread-stubs-0.4-h36c2ea0_1001
  pycairo            conda-forge/linux-64::pycairo-1.20.1-py37hfff247e_0
  pyparsing          conda-forge/noarch::pyparsing-2.4.7-pyh9f0ad1d_0
  python-dateutil    conda-forge/noarch::python-dateutil-2.8.1-py_0
  python_abi         conda-forge/linux-64::python_abi-3.7-1_cp37m
  pytz               conda-forge/noarch::pytz-2021.1-pyhd8ed1ab_0
  rdkit              conda-forge/linux-64::rdkit-2021.03.3-py37haf5a968_0
  reportlab          conda-forge/linux-64::reportlab-3.5.67-py37h69800bb_0
  sqlalchemy         conda-forge/linux-64::sqlalchemy-1.4.18-py37h5e8e339_0
  tornado            conda-forge/linux-64::tornado-6.1-py37h5e8e339_1
  typing_extensions  conda-forge/noarch::typing_extensions-3.10.0.0-pyha770c72_0
  xorg-kbproto       conda-forge/linux-64::xorg-kbproto-1.0.7-h7f98852_1002
  xorg-libice        conda-forge/linux-64::xorg-libice-1.0.10-h7f98852_0
  xorg-libsm         conda-forge/linux-64::xorg-libsm-1.2.3-hd9c2040_1000
  xorg-libx11        conda-forge/linux-64::xorg-libx11-1.7.2-h7f98852_0
  xorg-libxau        conda-forge/linux-64::xorg-libxau-1.0.9-h7f98852_0
  xorg-libxdmcp      conda-forge/linux-64::xorg-libxdmcp-1.1.3-h7f98852_0
  xorg-libxext       conda-forge/linux-64::xorg-libxext-1.3.4-h7f98852_1
  xorg-libxrender    conda-forge/linux-64::xorg-libxrender-0.9.10-h7f98852_1003
  xorg-renderproto   conda-forge/linux-64::xorg-renderproto-0.11.1-h7f98852_1002
  xorg-xextproto     conda-forge/linux-64::xorg-xextproto-7.3.0-h7f98852_1002
  xorg-xproto        conda-forge/linux-64::xorg-xproto-7.0.31-h7f98852_1007
  zipp               conda-forge/noarch::zipp-3.4.1-pyhd8ed1ab_0
  zstd               conda-forge/linux-64::zstd-1.5.0-ha95c52a_0

The following packages will be UPDATED:

  ca-certificates    pkgs/main::ca-certificates-2021.5.25-~ --&gt; conda-forge::ca-certificates-2021.5.30-ha878542_0
  libgcc-ng                                9.1.0-hdf63c60_0 --&gt; 9.3.0-h5101ec6_17
  libstdcxx-ng       pkgs/main::libstdcxx-ng-9.1.0-hdf63c6~ --&gt; conda-forge::libstdcxx-ng-9.3.0-h6de172a_19

The following packages will be SUPERSEDED by a higher-priority channel:

  certifi            pkgs/main::certifi-2021.5.30-py37h06a~ --&gt; conda-forge::certifi-2021.5.30-py37h89c1867_0
  conda              pkgs/main::conda-4.10.1-py37h06a4308_1 --&gt; conda-forge::conda-4.10.1-py37h89c1867_0
  openssl              pkgs/main::openssl-1.1.1k-h27cfd23_0 --&gt; conda-forge::openssl-1.1.1k-h7f98852_0


Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /usr/local

  added / updated specs:
    - py3dmol


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    argon2-cffi-20.1.0         |   py37h5e8e339_2          47 KB  conda-forge
    async_generator-1.10       |             py_0          18 KB  conda-forge
    attrs-21.2.0               |     pyhd8ed1ab_0          44 KB  conda-forge
    backcall-0.2.0             |     pyh9f0ad1d_0          13 KB  conda-forge
    backports-1.0              |             py_2           4 KB  conda-forge
    backports.functools_lru_cache-1.6.4|     pyhd8ed1ab_0           9 KB  conda-forge
    bleach-3.3.0               |     pyh44b312d_0         111 KB  conda-forge
    dbus-1.13.6                |       h48d8840_2         572 KB  conda-forge
    decorator-5.0.9            |     pyhd8ed1ab_0          11 KB  conda-forge
    defusedxml-0.7.1           |     pyhd8ed1ab_0          23 KB  conda-forge
    entrypoints-0.3            |  pyhd8ed1ab_1003           8 KB  conda-forge
    expat-2.4.1                |       h9c3ff4c_0         182 KB  conda-forge
    glib-2.68.3                |       h9c3ff4c_0         449 KB  conda-forge
    glib-tools-2.68.3          |       h9c3ff4c_0          86 KB  conda-forge
    gst-plugins-base-1.14.5    |       h0935bb2_2         6.8 MB  conda-forge
    gstreamer-1.18.4           |       h76c114f_2         2.0 MB  conda-forge
    ipykernel-5.5.5            |   py37h085eea5_0         167 KB  conda-forge
    ipython-7.24.1             |   py37h085eea5_0         1.1 MB  conda-forge
    ipython_genutils-0.2.0     |             py_1          21 KB  conda-forge
    ipywidgets-7.6.3           |     pyhd3deb0d_0         101 KB  conda-forge
    jedi-0.18.0                |   py37h89c1867_2         923 KB  conda-forge
    jinja2-3.0.1               |     pyhd8ed1ab_0          99 KB  conda-forge
    jsonschema-3.2.0           |     pyhd8ed1ab_3          45 KB  conda-forge
    jupyter-1.0.0              |   py37h89c1867_6           6 KB  conda-forge
    jupyter_client-6.1.12      |     pyhd8ed1ab_0          79 KB  conda-forge
    jupyter_console-6.4.0      |     pyhd8ed1ab_0          22 KB  conda-forge
    jupyter_core-4.7.1         |   py37h89c1867_0          72 KB  conda-forge
    jupyterlab_pygments-0.1.2  |     pyh9f0ad1d_0           8 KB  conda-forge
    jupyterlab_widgets-1.0.0   |     pyhd8ed1ab_1         130 KB  conda-forge
    krb5-1.17.2                |       h926e7f8_0         1.4 MB  conda-forge
    libclang-11.1.0            |default_ha53f305_1        19.2 MB  conda-forge
    libevent-2.1.10            |       hcdb4288_3         1.1 MB  conda-forge
    libllvm11-11.1.0           |       hf817b99_2        29.1 MB  conda-forge
    libpq-12.3                 |       h255efa7_3         2.6 MB  conda-forge
    libsodium-1.0.18           |       h36c2ea0_1         366 KB  conda-forge
    libxkbcommon-1.0.3         |       he3ba5ed_0         581 KB  conda-forge
    markupsafe-2.0.1           |   py37h5e8e339_0          22 KB  conda-forge
    matplotlib-inline-0.1.2    |     pyhd8ed1ab_2          11 KB  conda-forge
    mistune-0.8.4              |py37h5e8e339_1003          54 KB  conda-forge
    mysql-common-8.0.25        |       ha770c72_2         1.6 MB  conda-forge
    mysql-libs-8.0.25          |       hfa10184_2         1.8 MB  conda-forge
    nbclient-0.5.3             |     pyhd8ed1ab_0          67 KB  conda-forge
    nbconvert-6.0.7            |   py37h89c1867_3         535 KB  conda-forge
    nbformat-5.1.3             |     pyhd8ed1ab_0          47 KB  conda-forge
    nest-asyncio-1.5.1         |     pyhd8ed1ab_0           9 KB  conda-forge
    notebook-6.4.0             |     pyha770c72_0         6.1 MB  conda-forge
    nspr-4.30                  |       h9c3ff4c_0         233 KB  conda-forge
    nss-3.67                   |       hb5efdd6_0         2.1 MB  conda-forge
    packaging-20.9             |     pyh44b312d_0          35 KB  conda-forge
    pandoc-2.14.0.2            |       h7f98852_0        12.0 MB  conda-forge
    pandocfilters-1.4.2        |             py_1           9 KB  conda-forge
    parso-0.8.2                |     pyhd8ed1ab_0          68 KB  conda-forge
    pexpect-4.8.0              |     pyh9f0ad1d_2          47 KB  conda-forge
    pickleshare-0.7.5          |          py_1003           9 KB  conda-forge
    prometheus_client-0.11.0   |     pyhd8ed1ab_0          46 KB  conda-forge
    prompt-toolkit-3.0.19      |     pyha770c72_0         244 KB  conda-forge
    prompt_toolkit-3.0.19      |       hd8ed1ab_0           4 KB  conda-forge
    ptyprocess-0.7.0           |     pyhd3deb0d_0          16 KB  conda-forge
    py3dmol-0.9.1              |     pyhd8ed1ab_0          10 KB  conda-forge
    pygments-2.9.0             |     pyhd8ed1ab_0         754 KB  conda-forge
    pyqt-5.12.3                |   py37h89c1867_7          21 KB  conda-forge
    pyqt-impl-5.12.3           |   py37he336c9b_7         5.9 MB  conda-forge
    pyqt5-sip-4.19.18          |   py37hcd2ae1e_7         310 KB  conda-forge
    pyqtchart-5.12             |   py37he336c9b_7         256 KB  conda-forge
    pyqtwebengine-5.12.1       |   py37he336c9b_7         175 KB  conda-forge
    pyrsistent-0.17.3          |   py37h5e8e339_2          89 KB  conda-forge
    pyzmq-22.1.0               |   py37h336d617_0         500 KB  conda-forge
    qt-5.12.9                  |       h9d6b050_2        99.5 MB  conda-forge
    qtconsole-5.1.0            |     pyhd8ed1ab_0          89 KB  conda-forge
    qtpy-1.9.0                 |             py_0          34 KB  conda-forge
    send2trash-1.5.0           |             py_0          12 KB  conda-forge
    sqlite-3.35.5              |       h74cdb3f_0         1.4 MB  conda-forge
    terminado-0.10.1           |   py37h89c1867_0          26 KB  conda-forge
    testpath-0.5.0             |     pyhd8ed1ab_0          86 KB  conda-forge
    traitlets-5.0.5            |             py_0          81 KB  conda-forge
    wcwidth-0.2.5              |     pyh9f0ad1d_2          33 KB  conda-forge
    webencodings-0.5.1         |             py_1          12 KB  conda-forge
    widgetsnbextension-3.5.1   |   py37h89c1867_4         1.8 MB  conda-forge
    zeromq-4.3.4               |       h9c3ff4c_0         352 KB  conda-forge
    ------------------------------------------------------------
                                           Total:       203.8 MB

The following NEW packages will be INSTALLED:

  argon2-cffi        conda-forge/linux-64::argon2-cffi-20.1.0-py37h5e8e339_2
  async_generator    conda-forge/noarch::async_generator-1.10-py_0
  attrs              conda-forge/noarch::attrs-21.2.0-pyhd8ed1ab_0
  backcall           conda-forge/noarch::backcall-0.2.0-pyh9f0ad1d_0
  backports          conda-forge/noarch::backports-1.0-py_2
  backports.functoo~ conda-forge/noarch::backports.functools_lru_cache-1.6.4-pyhd8ed1ab_0
  bleach             conda-forge/noarch::bleach-3.3.0-pyh44b312d_0
  dbus               conda-forge/linux-64::dbus-1.13.6-h48d8840_2
  decorator          conda-forge/noarch::decorator-5.0.9-pyhd8ed1ab_0
  defusedxml         conda-forge/noarch::defusedxml-0.7.1-pyhd8ed1ab_0
  entrypoints        conda-forge/noarch::entrypoints-0.3-pyhd8ed1ab_1003
  expat              conda-forge/linux-64::expat-2.4.1-h9c3ff4c_0
  glib               conda-forge/linux-64::glib-2.68.3-h9c3ff4c_0
  glib-tools         conda-forge/linux-64::glib-tools-2.68.3-h9c3ff4c_0
  gst-plugins-base   conda-forge/linux-64::gst-plugins-base-1.14.5-h0935bb2_2
  gstreamer          conda-forge/linux-64::gstreamer-1.18.4-h76c114f_2
  ipykernel          conda-forge/linux-64::ipykernel-5.5.5-py37h085eea5_0
  ipython            conda-forge/linux-64::ipython-7.24.1-py37h085eea5_0
  ipython_genutils   conda-forge/noarch::ipython_genutils-0.2.0-py_1
  ipywidgets         conda-forge/noarch::ipywidgets-7.6.3-pyhd3deb0d_0
  jedi               conda-forge/linux-64::jedi-0.18.0-py37h89c1867_2
  jinja2             conda-forge/noarch::jinja2-3.0.1-pyhd8ed1ab_0
  jsonschema         conda-forge/noarch::jsonschema-3.2.0-pyhd8ed1ab_3
  jupyter            conda-forge/linux-64::jupyter-1.0.0-py37h89c1867_6
  jupyter_client     conda-forge/noarch::jupyter_client-6.1.12-pyhd8ed1ab_0
  jupyter_console    conda-forge/noarch::jupyter_console-6.4.0-pyhd8ed1ab_0
  jupyter_core       conda-forge/linux-64::jupyter_core-4.7.1-py37h89c1867_0
  jupyterlab_pygmen~ conda-forge/noarch::jupyterlab_pygments-0.1.2-pyh9f0ad1d_0
  jupyterlab_widgets conda-forge/noarch::jupyterlab_widgets-1.0.0-pyhd8ed1ab_1
  krb5               conda-forge/linux-64::krb5-1.17.2-h926e7f8_0
  libclang           conda-forge/linux-64::libclang-11.1.0-default_ha53f305_1
  libevent           conda-forge/linux-64::libevent-2.1.10-hcdb4288_3
  libllvm11          conda-forge/linux-64::libllvm11-11.1.0-hf817b99_2
  libpq              conda-forge/linux-64::libpq-12.3-h255efa7_3
  libsodium          conda-forge/linux-64::libsodium-1.0.18-h36c2ea0_1
  libxkbcommon       conda-forge/linux-64::libxkbcommon-1.0.3-he3ba5ed_0
  markupsafe         conda-forge/linux-64::markupsafe-2.0.1-py37h5e8e339_0
  matplotlib-inline  conda-forge/noarch::matplotlib-inline-0.1.2-pyhd8ed1ab_2
  mistune            conda-forge/linux-64::mistune-0.8.4-py37h5e8e339_1003
  mysql-common       conda-forge/linux-64::mysql-common-8.0.25-ha770c72_2
  mysql-libs         conda-forge/linux-64::mysql-libs-8.0.25-hfa10184_2
  nbclient           conda-forge/noarch::nbclient-0.5.3-pyhd8ed1ab_0
  nbconvert          conda-forge/linux-64::nbconvert-6.0.7-py37h89c1867_3
  nbformat           conda-forge/noarch::nbformat-5.1.3-pyhd8ed1ab_0
  nest-asyncio       conda-forge/noarch::nest-asyncio-1.5.1-pyhd8ed1ab_0
  notebook           conda-forge/noarch::notebook-6.4.0-pyha770c72_0
  nspr               conda-forge/linux-64::nspr-4.30-h9c3ff4c_0
  nss                conda-forge/linux-64::nss-3.67-hb5efdd6_0
  packaging          conda-forge/noarch::packaging-20.9-pyh44b312d_0
  pandoc             conda-forge/linux-64::pandoc-2.14.0.2-h7f98852_0
  pandocfilters      conda-forge/noarch::pandocfilters-1.4.2-py_1
  parso              conda-forge/noarch::parso-0.8.2-pyhd8ed1ab_0
  pexpect            conda-forge/noarch::pexpect-4.8.0-pyh9f0ad1d_2
  pickleshare        conda-forge/noarch::pickleshare-0.7.5-py_1003
  prometheus_client  conda-forge/noarch::prometheus_client-0.11.0-pyhd8ed1ab_0
  prompt-toolkit     conda-forge/noarch::prompt-toolkit-3.0.19-pyha770c72_0
  prompt_toolkit     conda-forge/noarch::prompt_toolkit-3.0.19-hd8ed1ab_0
  ptyprocess         conda-forge/noarch::ptyprocess-0.7.0-pyhd3deb0d_0
  py3dmol            conda-forge/noarch::py3dmol-0.9.1-pyhd8ed1ab_0
  pygments           conda-forge/noarch::pygments-2.9.0-pyhd8ed1ab_0
  pyqt               conda-forge/linux-64::pyqt-5.12.3-py37h89c1867_7
  pyqt-impl          conda-forge/linux-64::pyqt-impl-5.12.3-py37he336c9b_7
  pyqt5-sip          conda-forge/linux-64::pyqt5-sip-4.19.18-py37hcd2ae1e_7
  pyqtchart          conda-forge/linux-64::pyqtchart-5.12-py37he336c9b_7
  pyqtwebengine      conda-forge/linux-64::pyqtwebengine-5.12.1-py37he336c9b_7
  pyrsistent         conda-forge/linux-64::pyrsistent-0.17.3-py37h5e8e339_2
  pyzmq              conda-forge/linux-64::pyzmq-22.1.0-py37h336d617_0
  qt                 conda-forge/linux-64::qt-5.12.9-h9d6b050_2
  qtconsole          conda-forge/noarch::qtconsole-5.1.0-pyhd8ed1ab_0
  qtpy               conda-forge/noarch::qtpy-1.9.0-py_0
  send2trash         conda-forge/noarch::send2trash-1.5.0-py_0
  terminado          conda-forge/linux-64::terminado-0.10.1-py37h89c1867_0
  testpath           conda-forge/noarch::testpath-0.5.0-pyhd8ed1ab_0
  traitlets          conda-forge/noarch::traitlets-5.0.5-py_0
  wcwidth            conda-forge/noarch::wcwidth-0.2.5-pyh9f0ad1d_2
  webencodings       conda-forge/noarch::webencodings-0.5.1-py_1
  widgetsnbextension conda-forge/linux-64::widgetsnbextension-3.5.1-py37h89c1867_4
  zeromq             conda-forge/linux-64::zeromq-4.3.4-h9c3ff4c_0

The following packages will be UPDATED:

  sqlite                pkgs/main::sqlite-3.33.0-h62c20be_0 --&gt; conda-forge::sqlite-3.35.5-h74cdb3f_0


Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... Enabling notebook extension jupyter-js-widgets/extension...
Paths used for configuration of notebook: 
    	/usr/local/etc/jupyter/nbconfig/notebook.d/plotlywidget.json
    	/usr/local/etc/jupyter/nbconfig/notebook.d/widgetsnbextension.json
    	/usr/local/etc/jupyter/nbconfig/notebook.json
Paths used for configuration of notebook: 
    	/usr/local/etc/jupyter/nbconfig/notebook.d/plotlywidget.json
    	/usr/local/etc/jupyter/nbconfig/notebook.d/widgetsnbextension.json
      - Validating: <span class="ansi-green-fg">OK</span>
Paths used for configuration of notebook: 
    	/usr/local/etc/jupyter/nbconfig/notebook.d/plotlywidget.json
    	/usr/local/etc/jupyter/nbconfig/notebook.d/widgetsnbextension.json
    	/usr/local/etc/jupyter/nbconfig/notebook.json

done
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  libopenbabel4v5
The following NEW packages will be installed:
  libopenbabel4v5 openbabel
0 upgraded, 2 newly installed, 0 to remove and 39 not upgraded.
Need to get 2,766 kB of archives.
After this operation, 11.8 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu bionic/universe amd64 libopenbabel4v5 amd64 2.3.2+dfsg-3build1 [2,664 kB]
Get:2 http://archive.ubuntu.com/ubuntu bionic/universe amd64 openbabel amd64 2.3.2+dfsg-3build1 [102 kB]
Fetched 2,766 kB in 2s (1,814 kB/s)
Selecting previously unselected package libopenbabel4v5.
(Reading database ... 160772 files and directories currently installed.)
Preparing to unpack .../libopenbabel4v5_2.3.2+dfsg-3build1_amd64.deb ...
Unpacking libopenbabel4v5 (2.3.2+dfsg-3build1) ...
Selecting previously unselected package openbabel.
Preparing to unpack .../openbabel_2.3.2+dfsg-3build1_amd64.deb ...
Unpacking openbabel (2.3.2+dfsg-3build1) ...
Setting up libopenbabel4v5 (2.3.2+dfsg-3build1) ...
Setting up openbabel (2.3.2+dfsg-3build1) ...
Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
Processing triggers for libc-bin (2.27-3ubuntu1.2) ...
/sbin/ldconfig.real: /usr/local/lib/python3.7/dist-packages/ideep4py/lib/libmkldnn.so.0 is not a symbolic link

Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /usr/local

  added / updated specs:
    - openbabel


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    openbabel-3.1.1            |   py37h200e996_1         5.5 MB  conda-forge
    ------------------------------------------------------------
                                           Total:         5.5 MB

The following NEW packages will be INSTALLED:

  openbabel          conda-forge/linux-64::openbabel-3.1.1-py37h200e996_1


Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  apbs libglew2.0 libmaloc1 pymol-data python-opengl python-pmw
Suggested packages:
  glew-utils libgle3 python-pmw-doc
The following NEW packages will be installed:
  apbs libglew2.0 libmaloc1 pymol pymol-data python-opengl python-pmw
0 upgraded, 7 newly installed, 0 to remove and 39 not upgraded.
Need to get 5,912 kB of archives.
After this operation, 26.3 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu bionic/universe amd64 libmaloc1 amd64 0.2-3.1 [48.3 kB]
Get:2 http://archive.ubuntu.com/ubuntu bionic/universe amd64 apbs amd64 1.4-1build1 [218 kB]
Get:3 http://archive.ubuntu.com/ubuntu bionic/universe amd64 libglew2.0 amd64 2.0.0-5 [140 kB]
Get:4 http://archive.ubuntu.com/ubuntu bionic/universe amd64 python-pmw all 1.3.2-6build1 [79.5 kB]
Get:5 http://archive.ubuntu.com/ubuntu bionic/universe amd64 python-opengl all 3.1.0+dfsg-1 [496 kB]
Get:6 http://archive.ubuntu.com/ubuntu bionic/universe amd64 pymol-data all 1.8.4.0+dfsg-1build1 [1,193 kB]
Get:7 http://archive.ubuntu.com/ubuntu bionic/universe amd64 pymol amd64 1.8.4.0+dfsg-1build1 [3,737 kB]
Fetched 5,912 kB in 2s (3,681 kB/s)
Selecting previously unselected package libmaloc1.
(Reading database ... 160977 files and directories currently installed.)
Preparing to unpack .../0-libmaloc1_0.2-3.1_amd64.deb ...
Unpacking libmaloc1 (0.2-3.1) ...
Selecting previously unselected package apbs.
Preparing to unpack .../1-apbs_1.4-1build1_amd64.deb ...
Unpacking apbs (1.4-1build1) ...
Selecting previously unselected package libglew2.0:amd64.
Preparing to unpack .../2-libglew2.0_2.0.0-5_amd64.deb ...
Unpacking libglew2.0:amd64 (2.0.0-5) ...
Selecting previously unselected package python-pmw.
Preparing to unpack .../3-python-pmw_1.3.2-6build1_all.deb ...
Unpacking python-pmw (1.3.2-6build1) ...
Selecting previously unselected package python-opengl.
Preparing to unpack .../4-python-opengl_3.1.0+dfsg-1_all.deb ...
Unpacking python-opengl (3.1.0+dfsg-1) ...
Selecting previously unselected package pymol-data.
Preparing to unpack .../5-pymol-data_1.8.4.0+dfsg-1build1_all.deb ...
Unpacking pymol-data (1.8.4.0+dfsg-1build1) ...
Selecting previously unselected package pymol.
Preparing to unpack .../6-pymol_1.8.4.0+dfsg-1build1_amd64.deb ...
Unpacking pymol (1.8.4.0+dfsg-1build1) ...
Setting up python-opengl (3.1.0+dfsg-1) ...
Setting up pymol-data (1.8.4.0+dfsg-1build1) ...
Setting up python-pmw (1.3.2-6build1) ...
Setting up libmaloc1 (0.2-3.1) ...
Setting up libglew2.0:amd64 (2.0.0-5) ...
Setting up apbs (1.4-1build1) ...
Setting up pymol (1.8.4.0+dfsg-1build1) ...
Processing triggers for mime-support (3.60ubuntu1) ...
Processing triggers for libc-bin (2.27-3ubuntu1.2) ...
/sbin/ldconfig.real: /usr/local/lib/python3.7/dist-packages/ideep4py/lib/libmkldnn.so.0 is not a symbolic link

Processing triggers for man-db (2.8.3-2ubuntu0.1) ...
--2021-06-18 15:19:52--  https://downloads.sourceforge.net/project/smina/smina.static
Resolving downloads.sourceforge.net (downloads.sourceforge.net)... 216.105.38.13
Connecting to downloads.sourceforge.net (downloads.sourceforge.net)|216.105.38.13|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://managedway.dl.sourceforge.net/project/smina/smina.static [following]
--2021-06-18 15:19:53--  https://managedway.dl.sourceforge.net/project/smina/smina.static
Resolving managedway.dl.sourceforge.net (managedway.dl.sourceforge.net)... 208.79.213.6
Connecting to managedway.dl.sourceforge.net (managedway.dl.sourceforge.net)|208.79.213.6|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 9853920 (9.4M) [application/octet-stream]
Saving to: â€˜smina.staticâ€™

smina.static        100%[===================&gt;]   9.40M  18.5MB/s    in 0.5s    

2021-06-18 15:19:53 (18.5 MB/s) - â€˜smina.staticâ€™ saved [9853920/9853920]

--2021-06-18 15:19:54--  https://github.com/gnina/gnina/releases/download/v1.0.1/gnina
Resolving github.com (github.com)... 140.82.114.4
Connecting to github.com (github.com)|140.82.114.4|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://github-releases.githubusercontent.com/45548146/47de2300-8bd4-11eb-8355-430c51e07fae?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210618%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20210618T151930Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=743c516d04d13df49d8b4c7625051818b41fd8314cb8327d0da2524b0d7d23ef&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=45548146&amp;response-content-disposition=attachment%3B%20filename%3Dgnina&amp;response-content-type=application%2Foctet-stream [following]
--2021-06-18 15:19:54--  https://github-releases.githubusercontent.com/45548146/47de2300-8bd4-11eb-8355-430c51e07fae?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210618%2Fus-east-1%2Fs3%2Faws4_request&amp;X-Amz-Date=20210618T151930Z&amp;X-Amz-Expires=300&amp;X-Amz-Signature=743c516d04d13df49d8b4c7625051818b41fd8314cb8327d0da2524b0d7d23ef&amp;X-Amz-SignedHeaders=host&amp;actor_id=0&amp;key_id=0&amp;repo_id=45548146&amp;response-content-disposition=attachment%3B%20filename%3Dgnina&amp;response-content-type=application%2Foctet-stream
Resolving github-releases.githubusercontent.com (github-releases.githubusercontent.com)... 185.199.111.154, 185.199.110.154, 185.199.109.154, ...
Connecting to github-releases.githubusercontent.com (github-releases.githubusercontent.com)|185.199.111.154|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 562802104 (537M) [application/octet-stream]
Saving to: â€˜gninaâ€™

gnina               100%[===================&gt;] 536.73M  91.7MB/s    in 6.4s    

2021-06-18 15:20:00 (84.1 MB/s) - â€˜gninaâ€™ saved [562802104/562802104]

Collecting package metadata (current_repodata.json): ...working... done
Solving environment: ...working... done

## Package Plan ##

  environment location: /usr/local

  added / updated specs:
    - plip


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    alsa-lib-1.2.3             |       h516909a_0         560 KB  conda-forge
    c-ares-1.17.1              |       h7f98852_1         109 KB  conda-forge
    curl-7.77.0                |       hea6ffbf_0         149 KB  conda-forge
    glew-2.1.0                 |       h9c3ff4c_2         647 KB  conda-forge
    glm-0.9.9.4                |       hc9558a2_0         201 KB  conda-forge
    gst-plugins-base-1.18.4    |       hf529b03_2         2.6 MB  conda-forge
    hdf4-4.2.15                |       h10796ff_3         950 KB  conda-forge
    hdf5-1.10.6                |nompi_h6a2412b_1114         3.1 MB  conda-forge
    krb5-1.19.1                |       hcc1bbae_0         1.4 MB  conda-forge
    libcurl-7.77.0             |       h2574ce0_0         334 KB  conda-forge
    libev-4.33                 |       h516909a_1         104 KB  conda-forge
    libglu-9.0.0               |    he1b5a44_1001         413 KB  conda-forge
    libnetcdf-4.7.4            |nompi_h56d31a8_107         1.3 MB  conda-forge
    libnghttp2-1.43.0          |       h812cca2_0         808 KB  conda-forge
    libogg-1.3.4               |       h7f98852_1         206 KB  conda-forge
    libopus-1.3.1              |       h7f98852_1         255 KB  conda-forge
    libpq-13.3                 |       hd57d9b9_0         2.7 MB  conda-forge
    libssh2-1.9.0              |       ha56f1ee_6         226 KB  conda-forge
    libvorbis-1.3.7            |       h9c3ff4c_0         280 KB  conda-forge
    libxslt-1.1.33             |       h15afd5d_2         522 KB  conda-forge
    lxml-4.6.3                 |   py37h77fd288_0         1.5 MB  conda-forge
    plip-2.2.2                 |     pyhd8ed1ab_0          63 KB  conda-forge
    pmw-2.0.1                  |py37h89c1867_1004         495 KB  conda-forge
    pymol-open-source-2.5.0    |   py37h84945d2_4         6.9 MB  conda-forge
    qt-5.12.9                  |       hda022c4_4        99.5 MB  conda-forge
    readline-8.1               |       h46c0cb4_0         295 KB  conda-forge
    ------------------------------------------------------------
                                           Total:       125.5 MB

The following NEW packages will be INSTALLED:

  alsa-lib           conda-forge/linux-64::alsa-lib-1.2.3-h516909a_0
  c-ares             conda-forge/linux-64::c-ares-1.17.1-h7f98852_1
  curl               conda-forge/linux-64::curl-7.77.0-hea6ffbf_0
  glew               conda-forge/linux-64::glew-2.1.0-h9c3ff4c_2
  glm                conda-forge/linux-64::glm-0.9.9.4-hc9558a2_0
  hdf4               conda-forge/linux-64::hdf4-4.2.15-h10796ff_3
  hdf5               conda-forge/linux-64::hdf5-1.10.6-nompi_h6a2412b_1114
  libcurl            conda-forge/linux-64::libcurl-7.77.0-h2574ce0_0
  libev              conda-forge/linux-64::libev-4.33-h516909a_1
  libglu             conda-forge/linux-64::libglu-9.0.0-he1b5a44_1001
  libnetcdf          conda-forge/linux-64::libnetcdf-4.7.4-nompi_h56d31a8_107
  libnghttp2         conda-forge/linux-64::libnghttp2-1.43.0-h812cca2_0
  libogg             conda-forge/linux-64::libogg-1.3.4-h7f98852_1
  libopus            conda-forge/linux-64::libopus-1.3.1-h7f98852_1
  libssh2            conda-forge/linux-64::libssh2-1.9.0-ha56f1ee_6
  libvorbis          conda-forge/linux-64::libvorbis-1.3.7-h9c3ff4c_0
  libxslt            conda-forge/linux-64::libxslt-1.1.33-h15afd5d_2
  lxml               conda-forge/linux-64::lxml-4.6.3-py37h77fd288_0
  plip               conda-forge/noarch::plip-2.2.2-pyhd8ed1ab_0
  pmw                conda-forge/linux-64::pmw-2.0.1-py37h89c1867_1004
  pymol-open-source  conda-forge/linux-64::pymol-open-source-2.5.0-py37h84945d2_4

The following packages will be UPDATED:

  gst-plugins-base                        1.14.5-h0935bb2_2 --&gt; 1.18.4-hf529b03_2
  krb5                                    1.17.2-h926e7f8_0 --&gt; 1.19.1-hcc1bbae_0
  libpq                                     12.3-h255efa7_3 --&gt; 13.3-hd57d9b9_0
  qt                                      5.12.9-h9d6b050_2 --&gt; 5.12.9-hda022c4_4
  readline               pkgs/main::readline-8.0-h7b6447c_0 --&gt; conda-forge::readline-8.1-h46c0cb4_0


Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Scripts-de-analisis">Scripts de analisis<a class="anchor-link" href="#Scripts-de-analisis"> </a></h1>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="k">def</span> <span class="nf">get_center</span><span class="p">(</span><span class="n">ligando</span><span class="p">):</span>
  <span class="n">atoms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">i</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">],</span> <span class="n">i</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">ligando</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
  <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">atoms</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.3f</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>


<span class="c1"># visualizacion de modelos</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span><span class="n">fixed</span><span class="p">,</span><span class="n">IntSlider</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span>
<span class="kn">from</span> <span class="nn">openbabel</span> <span class="kn">import</span> <span class="n">pybel</span>

<span class="k">def</span> <span class="nf">MolTo3DView</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>

    <span class="n">mol</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">,</span><span class="s1">&#39;mol.sdf&#39;</span><span class="p">,</span><span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">py3Dmol</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;receptor.pdb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;cartoon&#39;</span><span class="p">:{},</span><span class="s1">&#39;stick&#39;</span><span class="p">:{</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">1</span><span class="p">}})</span>
    <span class="n">v</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;control.pdb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">},{</span><span class="s1">&#39;stick&#39;</span><span class="p">:{</span><span class="s1">&#39;colorscheme&#39;</span><span class="p">:</span><span class="s1">&#39;dimgrayCarbon&#39;</span><span class="p">,</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">125</span><span class="p">}})</span>
    <span class="n">v</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;mol.sdf&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">},{</span><span class="s1">&#39;stick&#39;</span><span class="p">:{</span><span class="s1">&#39;colorscheme&#39;</span><span class="p">:</span><span class="s1">&#39;greenCarbon&#39;</span><span class="p">}})</span>
    <span class="n">v</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">v</span>

<span class="c1"># visualizacion de interacciones</span>
<span class="k">class</span> <span class="nc">Atom</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;resname&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;chain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">21</span><span class="p">:</span><span class="mi">22</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;resid&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]))</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">])</span>
        <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;sym&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>
        
        <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">16</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">17</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;resname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">26</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;resid&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">38</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">38</span><span class="p">:</span><span class="mi">46</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">46</span><span class="p">:</span><span class="mi">54</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="s2">&quot;z&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="n">line</span><span class="p">[</span><span class="mi">76</span><span class="p">:</span><span class="mi">78</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="s2">&quot;sym&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">line</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>

<span class="k">class</span> <span class="nc">Molecule</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;ATOM&quot;</span><span class="p">,</span> <span class="s2">&quot;HETATM&quot;</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Atom</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            
    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outstr</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">outstr</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">at</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">outstr</span>

<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>


<span class="k">def</span> <span class="nf">getresidues</span><span class="p">(</span><span class="n">report</span><span class="p">):</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">bindingsite</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s1">&#39;bindingsite&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bindingsite</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;has_interactions&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">bs_residue</span> <span class="ow">in</span> <span class="n">bindingsite</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;bs_residues&#39;</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bs_residue</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span><span class="p">:</span>
                    <span class="n">residues</span><span class="p">[</span><span class="n">bs_residue</span><span class="o">.</span><span class="n">text</span><span class="p">]</span> <span class="o">=</span> <span class="n">bs_residue</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;aa&#39;</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">residues</span>


<span class="k">def</span> <span class="nf">getligand</span><span class="p">(</span><span class="n">report</span><span class="p">):</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">bindingsite</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s1">&#39;bindingsite&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bindingsite</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;has_interactions&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">bindingsite</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;identifiers/hetid&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>


<span class="k">def</span> <span class="nf">getinteractions</span><span class="p">(</span><span class="n">report</span><span class="p">):</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="n">inter_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bindingsite</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s1">&#39;bindingsite&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bindingsite</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;has_interactions&#39;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">interactions</span> <span class="ow">in</span> <span class="n">bindingsite</span><span class="o">.</span><span class="n">iter</span><span class="p">(</span><span class="s1">&#39;interactions&#39;</span><span class="p">):</span>
                <span class="n">hydrogen_bonds</span> <span class="o">=</span> <span class="n">interactions</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
                    <span class="s1">&#39;hydrogen_bonds/hydrogen_bond&#39;</span><span class="p">)</span>
                <span class="n">inter_list</span> <span class="o">+=</span> <span class="n">get_interaction</span><span class="p">(</span>
                    <span class="n">hydrogen_bonds</span><span class="p">,</span> <span class="s1">&#39;hbond&#39;</span><span class="p">)</span>

                <span class="n">hydrophobic_interactions</span> <span class="o">=</span> <span class="n">interactions</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
                    <span class="s1">&#39;hydrophobic_interactions/hydrophobic_interaction&#39;</span><span class="p">)</span>
                <span class="n">inter_list</span> <span class="o">+=</span> <span class="n">get_interaction</span><span class="p">(</span>
                    <span class="n">hydrophobic_interactions</span><span class="p">,</span> <span class="s1">&#39;hphobic&#39;</span><span class="p">)</span>

                <span class="n">salt_bridges</span> <span class="o">=</span> <span class="n">interactions</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
                    <span class="s1">&#39;salt_bridges/salt_bridge&#39;</span><span class="p">)</span>
                <span class="n">inter_list</span> <span class="o">+=</span> <span class="n">get_interaction</span><span class="p">(</span>
                    <span class="n">salt_bridges</span><span class="p">,</span> <span class="s1">&#39;sbridge&#39;</span><span class="p">)</span>

                <span class="n">pi_stacks</span> <span class="o">=</span> <span class="n">interactions</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;pi_stacks/pi_stack&#39;</span><span class="p">)</span>
                <span class="n">inter_list</span> <span class="o">+=</span> <span class="n">get_interaction</span><span class="p">(</span>
                    <span class="n">pi_stacks</span><span class="p">,</span> <span class="s1">&#39;pistack&#39;</span><span class="p">)</span>

                <span class="n">pi_cation_interactions</span> <span class="o">=</span> <span class="n">interactions</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
                    <span class="s1">&#39;pi_cation_interactions/pi_cation_interaction&#39;</span><span class="p">)</span>
                <span class="n">inter_list</span> <span class="o">+=</span> <span class="n">get_interaction</span><span class="p">(</span>
                    <span class="n">pi_cation_interactions</span><span class="p">,</span> <span class="s1">&#39;pication&#39;</span><span class="p">)</span>

                <span class="n">halogen_bonds</span> <span class="o">=</span> <span class="n">interactions</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span>
                     <span class="s1">&#39;halogen_bonds/halogen_bonds&#39;</span><span class="p">)</span>
                
                <span class="n">inter_list</span> <span class="o">+=</span> <span class="n">get_interaction</span><span class="p">(</span>
                    <span class="n">halogen_bonds</span><span class="p">,</span> <span class="s1">&#39;halogen&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">inter_list</span>


<span class="k">def</span> <span class="nf">get_interaction</span><span class="p">(</span><span class="n">interaction</span><span class="p">,</span> <span class="n">inter_type</span><span class="p">):</span>
    <span class="n">interactions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interaction</span><span class="p">:</span>
        <span class="n">interactions</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;inter_type&#39;</span><span class="p">:</span> <span class="n">inter_type</span><span class="p">,</span>
                 <span class="s1">&#39;resnr&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;resnr&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                 <span class="s1">&#39;restype&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;restype&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                 <span class="s1">&#39;reschain&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;reschain&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                 <span class="s1">&#39;resnr_lig&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;resnr_lig&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                 <span class="s1">&#39;restype_lig&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;restype_lig&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                 <span class="s1">&#39;reschain_lig&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;reschain_lig&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">,</span>
                 <span class="s1">&#39;ligcoo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]],</span>
                 <span class="s1">&#39;protcoo&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">i</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;protcoo&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]})</span>
    <span class="k">return</span> <span class="n">edit_interaction</span><span class="p">(</span><span class="n">interactions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">edit_interaction</span><span class="p">(</span><span class="n">interactions</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interactions</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;inter_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hbond&#39;</span><span class="p">:</span>
      <span class="n">i</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
      <span class="n">i</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span>
    <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;inter_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hphobic&#39;</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="kc">True</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span>
    <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;inter_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sbridge&#39;</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="kc">True</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;sphere&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span>
    <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;inter_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pistack&#39;</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;sphere&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;inter_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pication&#39;</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;sphere&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
    <span class="k">elif</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;inter_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;halogen&#39;</span><span class="p">:</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">i</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;cyan&#39;</span>
      
  <span class="k">return</span> <span class="n">interactions</span>

<span class="k">def</span> <span class="nf">draw_interaction</span><span class="p">(</span><span class="n">interaction</span><span class="p">):</span>
  <span class="n">view</span><span class="o">.</span><span class="n">addCylinder</span><span class="p">({</span>
  <span class="s1">&#39;radius&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;start&#39;</span><span class="p">:{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]},</span>
  <span class="s1">&#39;end&#39;</span><span class="p">:{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]},</span> 
  <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">],</span>
  <span class="s1">&#39;dashed&#39;</span><span class="p">:</span> <span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;dashed&#39;</span><span class="p">],</span>
  <span class="s1">&#39;fromCap&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
  <span class="s1">&#39;toCap&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
  <span class="k">if</span> <span class="s1">&#39;sphere&#39;</span> <span class="ow">in</span> <span class="n">interaction</span><span class="p">:</span>
    <span class="n">view</span><span class="o">.</span><span class="n">addSphere</span><span class="p">({</span>
      <span class="s1">&#39;center&#39;</span><span class="p">:{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;ligcoo&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]},</span>
      <span class="s1">&#39;radius&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;sphere&#39;</span><span class="p">]})</span>
    <span class="n">view</span><span class="o">.</span><span class="n">addSphere</span><span class="p">({</span>
      <span class="s1">&#39;center&#39;</span><span class="p">:{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]},</span> 
      <span class="s1">&#39;radius&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span>
      <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="n">interaction</span><span class="p">[</span><span class="s1">&#39;sphere&#39;</span><span class="p">]})</span>

<span class="c1">#etiquetas</span>
<span class="n">label</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;restype&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">(),</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">],</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;reschain&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">%%</span><span class="n">bash</span>
<span class="n">cat</span> <span class="o">&gt;</span> <span class="n">calcular_interacciones</span><span class="o">.</span><span class="n">sh</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span>
<span class="n">CreateComplex</span><span class="p">(){</span>
        <span class="nb">id</span><span class="o">=</span>\<span class="err">$</span><span class="mi">1</span>
        <span class="n">prot</span><span class="o">=</span>\<span class="err">$</span><span class="mi">2</span>
        <span class="n">echo</span> \<span class="err">$</span><span class="nb">id</span>
        <span class="n">obabel</span> \<span class="err">$</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="n">_out</span><span class="o">.</span><span class="n">sdf</span> <span class="o">-</span><span class="n">O</span> \<span class="err">$</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="n">_out</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">m</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> \<span class="err">$</span><span class="p">(</span><span class="n">ls</span> \<span class="err">$</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="n">_out</span><span class="o">*.</span><span class="n">pdb</span><span class="p">)</span>
        <span class="n">do</span>
                <span class="n">grep</span> <span class="s2">&quot;ATOM\|HETATM&quot;</span> \<span class="err">$</span><span class="n">prot</span> <span class="o">&gt;</span> <span class="n">complejo_</span>\<span class="err">$</span><span class="n">i</span>
                <span class="n">echo</span> <span class="n">TER</span> <span class="o">&gt;&gt;</span> <span class="n">complejo_</span>\<span class="err">$</span><span class="n">i</span>
                <span class="n">grep</span> <span class="s2">&quot;ATOM\|HETATM&quot;</span> \<span class="err">$</span><span class="n">i</span> <span class="o">|</span> <span class="n">sed</span> <span class="s1">&#39;s/ATOM  /HETATM/g&#39;</span><span class="o">&gt;&gt;</span> <span class="n">complejo_</span>\<span class="err">$</span><span class="n">i</span>
                <span class="n">plip</span> <span class="o">-</span><span class="n">f</span> <span class="n">complejo_</span>\<span class="err">$</span><span class="n">i</span> <span class="o">-</span><span class="n">x</span> <span class="o">--</span><span class="n">name</span> \<span class="err">$</span><span class="n">i</span>
                <span class="n">rm</span> <span class="n">complejo_</span>\<span class="err">$</span><span class="n">i</span>
        <span class="n">done</span>
        <span class="n">rm</span> \<span class="err">$</span><span class="p">{</span><span class="nb">id</span><span class="p">}</span><span class="n">_out</span><span class="o">*.</span><span class="n">pdb</span>
<span class="p">}</span>
<span class="nb">list</span><span class="o">=</span>\<span class="err">$</span><span class="mi">1</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> \<span class="err">$</span><span class="p">(</span><span class="n">cat</span> \<span class="err">$</span><span class="nb">list</span><span class="p">)</span>
<span class="n">do</span>
  <span class="n">CreateComplex</span> \<span class="err">$</span><span class="n">line</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span>
<span class="n">done</span>
<span class="n">EOF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">%%</span><span class="n">bash</span>
<span class="n">cat</span> <span class="o">&gt;</span> <span class="n">reports2csv</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span>
<span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">aa</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ASP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acidic&#39;</span><span class="p">,</span> <span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;charged&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;GLU&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acidic&#39;</span><span class="p">,</span> <span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;charged&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;negative&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ALA&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;aliphatic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">],</span>
        <span class="s1">&#39;GLY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;aliphatic&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;LEU&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;aliphatic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">],</span>
        <span class="s1">&#39;SER&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;VAL&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;aliphatic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">],</span>
        <span class="s1">&#39;THR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;LYS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;basic&#39;</span><span class="p">,</span> <span class="s1">&#39;charged&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ILE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;aliphatic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ASN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;GLN&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;CYS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">],</span>
        <span class="s1">&#39;MET&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;acyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">],</span>
        <span class="s1">&#39;HIS&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aromatic&#39;</span><span class="p">,</span> <span class="s1">&#39;basic&#39;</span><span class="p">,</span> <span class="s1">&#39;charged&#39;</span><span class="p">,</span> <span class="s1">&#39;cyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;PHE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aromatic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;cyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">],</span>
        <span class="s1">&#39;TRP&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aromatic&#39;</span><span class="p">,</span> <span class="s1">&#39;buried&#39;</span><span class="p">,</span> <span class="s1">&#39;cyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">],</span>
        <span class="s1">&#39;TYR&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;aromatic&#39;</span><span class="p">,</span> <span class="s1">&#39;cyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;ARG&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;basic&#39;</span><span class="p">,</span> <span class="s1">&#39;charged&#39;</span><span class="p">,</span> <span class="s1">&#39;large&#39;</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="s1">&#39;positive&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">],</span>
        <span class="s1">&#39;PRO&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;cyclic&#39;</span><span class="p">,</span> <span class="s1">&#39;hydrophobic&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;surface&#39;</span><span class="p">]}</span>

<span class="n">ii</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;hydrophobic_interaction&#39;</span><span class="p">:</span> <span class="s1">&#39;hphobic&#39;</span><span class="p">,</span>
        <span class="s1">&#39;hydrogen_bond&#39;</span><span class="p">:</span><span class="s1">&#39;hbond&#39;</span><span class="p">,</span>
        <span class="s1">&#39;water_bridge&#39;</span><span class="p">:</span><span class="s1">&#39;water&#39;</span><span class="p">,</span>
        <span class="s1">&#39;salt_bridge&#39;</span><span class="p">:</span><span class="s1">&#39;sbridge&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pi_stack&#39;</span><span class="p">:</span><span class="s1">&#39;pistack&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pi_cation_interaction&#39;</span><span class="p">:</span><span class="s1">&#39;pication&#39;</span><span class="p">,</span>
        <span class="s1">&#39;halogen_bond&#39;</span><span class="p">:</span><span class="s1">&#39;halogen&#39;</span><span class="p">,</span>
        <span class="s1">&#39;metal_complex&#39;</span><span class="p">:</span><span class="s1">&#39;metal&#39;</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">get_bsresidues</span><span class="p">(</span><span class="n">bs_residues</span><span class="p">):</span>
    <span class="n">bsresidues</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">bs_residues</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;contact&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
            <span class="n">bsresidues</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">aa</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;aa&#39;</span><span class="p">]])</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">bsresidues</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_ligproperties</span><span class="p">(</span><span class="n">lig_properties</span><span class="p">):</span>
    <span class="n">ligproperties</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">lig_properties</span><span class="p">:</span>
        <span class="n">ligproperties</span><span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">text</span>

    <span class="k">return</span> <span class="n">ligproperties</span>

<span class="k">def</span> <span class="nf">get_interactions</span><span class="p">(</span><span class="n">_interactions</span><span class="p">):</span>
    <span class="n">interactions</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">_interactions</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">subelement</span> <span class="ow">in</span> <span class="n">element</span><span class="p">:</span>
            <span class="n">intertype</span> <span class="o">=</span> <span class="n">ii</span><span class="p">[</span><span class="n">subelement</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span>
            <span class="n">resnr</span> <span class="o">=</span> <span class="n">subelement</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;resnr&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
            <span class="n">restype</span> <span class="o">=</span> <span class="n">subelement</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;restype&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
            <span class="n">reschain</span> <span class="o">=</span> <span class="n">subelement</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;reschain&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
            <span class="n">interactions</span><span class="o">.</span><span class="n">update</span><span class="p">([</span><span class="n">intertype</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">restype</span><span class="o">.</span><span class="n">title</span><span class="p">()</span> <span class="o">+</span> <span class="n">resnr</span> <span class="o">+</span> <span class="n">reschain</span><span class="p">])</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">interactions</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">parse_bindingsite</span><span class="p">(</span><span class="n">bindingsite</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">bindingsite</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;lig_properties&#39;</span><span class="p">:</span>
            <span class="n">ligproperties</span> <span class="o">=</span> <span class="n">get_ligproperties</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;bs_residues&#39;</span><span class="p">:</span>
            <span class="n">bsresidues</span> <span class="o">=</span> <span class="n">get_bsresidues</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">element</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;interactions&#39;</span><span class="p">:</span>
            <span class="n">interactions</span> <span class="o">=</span> <span class="n">get_interactions</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ligproperties</span><span class="p">,</span> <span class="n">bsresidues</span><span class="p">,</span> <span class="n">interactions</span>

<span class="k">def</span> <span class="nf">parse_report</span><span class="p">(</span><span class="n">xml</span><span class="p">):</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">xml</span><span class="p">)</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">root</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;bindingsite&#39;</span><span class="p">:</span>
            <span class="n">ligproperties</span><span class="p">,</span> <span class="n">bsresidues</span><span class="p">,</span> <span class="n">interactions</span>  <span class="o">=</span> <span class="n">parse_bindingsite</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="n">ligproperties</span><span class="p">,</span> <span class="o">**</span><span class="n">bsresidues</span><span class="p">,</span> <span class="o">**</span><span class="n">interactions</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">infile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># reports list</span>
    <span class="n">outfile</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># out.csv</span>

    <span class="n">rename</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;out&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="n">reports</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">report</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="n">infile</span><span class="p">):</span>
        <span class="n">report</span> <span class="o">=</span> <span class="n">report</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">rename</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
        <span class="n">reports</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_report</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">reports</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">)</span>

<span class="n">main</span><span class="p">()</span>
<span class="n">EOF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Practica-#2">Practica #2<a class="anchor-link" href="#Practica-#2"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preparacion">Preparacion<a class="anchor-link" href="#Preparacion"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preparacion-de-receptor">Preparacion de receptor<a class="anchor-link" href="#Preparacion-de-receptor"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">files</span><span class="o">.</span><span class="n">rcsb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="mi">6</span><span class="n">ZRU</span><span class="o">.</span><span class="n">pdb</span>

<span class="c1"># Extraer atomos de la proteÃ­na</span>
<span class="err">!</span><span class="n">grep</span> <span class="n">ATOM</span> <span class="mi">6</span><span class="n">ZRU</span><span class="o">.</span><span class="n">pdb</span> <span class="o">|</span> <span class="n">awk</span> <span class="o">-</span><span class="n">v</span> <span class="n">FS</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="s1">&#39;$22 == &quot;A&quot; {print $0}&#39;</span> <span class="o">&gt;</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span>

<span class="c1"># Preparar estructura del receptor</span>
<span class="err">!</span><span class="n">pymol</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;remove resn HOH;h_add acceptors or donors;save receptor.pdb&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--2021-06-18 15:10:40--  http://files.rcsb.org/download/6ZRU.pdb
Resolving files.rcsb.org (files.rcsb.org)... 128.6.158.70
Connecting to files.rcsb.org (files.rcsb.org)|128.6.158.70|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [application/octet-stream]
Saving to: â€˜6ZRU.pdbâ€™

6ZRU.pdb                [ &lt;=&gt;                ] 227.26K  --.-KB/s    in 0.03s   

2021-06-18 15:10:40 (7.95 MB/s) - â€˜6ZRU.pdbâ€™ saved [232713]

 PyMOL(TM) Molecular Graphics System, Version 2.5.0.
 Copyright (c) Schrodinger, LLC.
 All Rights Reserved.
 
    Created by Warren L. DeLano, Ph.D. 
 
    PyMOL is user-supported open-source software.  Although some versions
    are freely available, PyMOL is not in the public domain.
 
    If PyMOL is helpful in your work or study, then please volunteer 
    support for our ongoing efforts to create open and affordable scientific
    software by purchasing a PyMOL Maintenance and/or Support subscription.

    More information can be found at &#34;http://www.pymol.org&#34;.
 
    Enter &#34;help&#34; for a list of commands.
    Enter &#34;help &lt;command-name&gt;&#34; for information on a specific command.

 Hit ESC anytime to toggle between text and graphics.

 Detected 2 CPU cores.  Enabled multithreaded rendering.
 CmdLoad: &#34;&#34; loaded as &#34;receptor&#34;.
PyMOL&gt;remove resn HOH;h_add acceptors or donors;save receptor.pdb
 Save: wrote &#34;receptor.pdb&#34;.
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preparacion-de-ligando">Preparacion de ligando<a class="anchor-link" href="#Preparacion-de-ligando"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">grep</span> <span class="o">-</span><span class="n">E</span> <span class="n">HETATM</span><span class="o">.*</span><span class="n">U5G</span> <span class="mi">6</span><span class="n">ZRU</span><span class="o">.</span><span class="n">pdb</span> <span class="o">|</span> <span class="n">awk</span> <span class="o">-</span><span class="n">v</span> <span class="n">FS</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="s1">&#39;$22 == &quot;A&quot; {print $0}&#39;</span> <span class="o">&gt;</span> <span class="n">control</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">files</span><span class="o">.</span><span class="n">rcsb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">ligands</span><span class="o">/</span><span class="n">view</span><span class="o">/</span><span class="n">U5G_ideal</span><span class="o">.</span><span class="n">sdf</span>
<span class="c1">#!obabel -:&#39;CC1([C@@H]2[C@H]1[C@H](N(C2)C(=O)[C@H](C(C)(C)C)NC(=O)NC(C)(C)C)C(=O)N[C@@H](CC3CCC3)[C@H](C(=O)N)O)C&#39; --gen3D best -O ligando.pdb</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--2021-06-18 15:10:41--  https://files.rcsb.org/ligands/view/U5G_ideal.sdf
Resolving files.rcsb.org (files.rcsb.org)... 128.6.158.70
Connecting to files.rcsb.org (files.rcsb.org)|128.6.158.70|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: unspecified [text/plain]
Saving to: â€˜U5G_ideal.sdfâ€™

U5G_ideal.sdf           [ &lt;=&gt;                ]   8.10K  --.-KB/s    in 0s      

2021-06-18 15:10:41 (89.3 MB/s) - â€˜U5G_ideal.sdfâ€™ saved [8291]

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Acoplamiento-molecular">Acoplamiento molecular<a class="anchor-link" href="#Acoplamiento-molecular"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="o">./</span><span class="n">gnina</span> <span class="o">-</span><span class="n">r</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">l</span> <span class="n">U5G_ideal</span><span class="o">.</span><span class="n">sdf</span> <span class="o">--</span><span class="n">autobox_ligand</span> <span class="n">control</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">o</span> <span class="n">gnina_lig</span><span class="o">.</span><span class="n">sdf</span> <span class="o">--</span><span class="n">cnn_scoring</span><span class="o">=</span><span class="n">none</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              _             
             (_)            
   __ _ _ __  _ _ __   __ _ 
  / _` | &#39;_ \| | &#39;_ \ / _` |
 | (_| | | | | | | | | (_| |
  \__, |_| |_|_|_| |_|\__,_|
   __/ |                    
  |___/                     

gnina v1.0.1 HEAD:aa41230   Built Mar 23 2021.
gnina is based on smina and AutoDock Vina.
Please cite appropriately.

Commandline: ./gnina -r receptor.pdb -l U5G_ideal.sdf --autobox_ligand control.pdb -o gnina_lig.sdf --cnn_scoring=none
Using random seed: -752763284

0%   10   20   30   40   50   60   70   80   90   100%
|----|----|----|----|----|----|----|----|----|----|
**********************************</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Analisis-de-resultados">Analisis de resultados<a class="anchor-link" href="#Analisis-de-resultados"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="RMSD">RMSD<a class="anchor-link" href="#RMSD"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">obrms</span> <span class="o">--</span><span class="n">firstonly</span> <span class="n">control</span><span class="o">.</span><span class="n">pdb</span> <span class="n">gnina_lig</span><span class="o">.</span><span class="n">sdf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualizacion">Visualizacion<a class="anchor-link" href="#Visualizacion"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">confs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span>  <span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">,</span> <span class="s1">&#39;gnina_lig.sdf&#39;</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">conf_viewer</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">confs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">MolTo3DView</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">interact</span><span class="p">(</span><span class="n">conf_viewer</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">9</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Calculo-de-interacciones">Calculo de interacciones<a class="anchor-link" href="#Calculo-de-interacciones"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="control">control<a class="anchor-link" href="#control"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">cat</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">echo</span> <span class="n">TER</span> <span class="o">&gt;&gt;</span> <span class="n">complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">grep</span> <span class="n">HETATM</span> <span class="n">ligando</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;&gt;</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">plip</span> <span class="o">-</span><span class="n">f</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">t</span> <span class="o">--</span><span class="n">name</span> <span class="n">control_interacciones</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="gnina">gnina<a class="anchor-link" href="#gnina"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">obabel</span> <span class="n">gnina_lig</span><span class="o">.</span><span class="n">sdf</span> <span class="o">-</span><span class="n">f1</span> <span class="o">-</span><span class="n">l1</span> <span class="o">-</span><span class="n">O</span> <span class="n">gnina_lig_best</span><span class="o">.</span><span class="n">pdb</span> 

<span class="c1"># Construccion del complejo receptor-ligando</span>
<span class="err">!</span><span class="n">grep</span> <span class="s2">&quot;ATOM\|HETATM&quot;</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;</span> <span class="n">gnina_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">echo</span> <span class="n">TER</span> <span class="o">&gt;&gt;</span> <span class="n">gnina_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">grep</span> <span class="n">HETATM</span> <span class="n">gnina_lig_best</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;&gt;</span> <span class="n">gnina_complejo</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">plip</span> <span class="o">-</span><span class="n">f</span> <span class="n">gnina_complejo</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">tx</span> <span class="o">--</span><span class="n">name</span> <span class="n">gnina_interacciones</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">interactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">getinteractions</span><span class="p">(</span><span class="s1">&#39;gnina_interacciones.xml&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;restype_lig&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;UNL&#39;</span><span class="p">]</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interactions</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;gnina_complejo_protonated.pdb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>

<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">mol</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;resid&quot;</span><span class="p">])</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">at</span><span class="p">[</span><span class="s2">&quot;pymol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="k">elif</span> <span class="n">at</span><span class="p">[</span><span class="s2">&quot;resname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;UNL&#39;</span><span class="p">:</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="n">at</span>
        <span class="n">at</span><span class="p">[</span><span class="s2">&quot;pymol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colorscheme&#39;</span><span class="p">:</span> <span class="s1">&#39;greenCarbon&#39;</span><span class="p">}}</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">py3Dmol</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">}}</span>
  <span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;serial&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">},</span> <span class="n">at</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pymol&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
  <span class="n">view</span><span class="o">.</span><span class="n">setColorByElement</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pymol&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interactions</span><span class="p">:</span>
  <span class="n">draw_interaction</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
    <span class="n">view</span><span class="o">.</span><span class="n">addLabel</span><span class="p">(</span><span class="n">label</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                  <span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                   <span class="s1">&#39;position&#39;</span><span class="p">:</span>
                   <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]},</span>
                   <span class="s1">&#39;screenOffset&#39;</span><span class="p">:{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}})</span>
    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">])</span>
<span class="n">view</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;resn&#39;</span><span class="p">:</span> <span class="s1">&#39;UNL&#39;</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;control.pdb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">},{</span><span class="s1">&#39;stick&#39;</span><span class="p">:{</span><span class="s1">&#39;colorscheme&#39;</span><span class="p">:</span><span class="s1">&#39;dimgrayCarbon&#39;</span><span class="p">,</span><span class="s1">&#39;radius&#39;</span><span class="p">:</span><span class="o">.</span><span class="mi">125</span><span class="p">}})</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Practica-#3">Practica #3<a class="anchor-link" href="#Practica-#3"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Acoplamiento-multiple">Acoplamiento multiple<a class="anchor-link" href="#Acoplamiento-multiple"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Preparacion-de-moleculas">Preparacion de moleculas<a class="anchor-link" href="#Preparacion-de-moleculas"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Preparacion-del-receptor">Preparacion del receptor<a class="anchor-link" href="#Preparacion-del-receptor"> </a></h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">files</span><span class="o">.</span><span class="n">rcsb</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">download</span><span class="o">/</span><span class="mi">7</span><span class="n">JKV</span><span class="o">.</span><span class="n">pdb</span>

<span class="c1"># Extraer atomos de la proteÃ­na</span>
<span class="err">!</span><span class="n">grep</span> <span class="n">ATOM</span> <span class="mi">7</span><span class="n">JKV</span><span class="o">.</span><span class="n">pdb</span> <span class="o">|</span> <span class="n">awk</span> <span class="o">-</span><span class="n">v</span> <span class="n">FS</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="s1">&#39;$22 == &quot;A&quot; {print $0}&#39;</span> <span class="o">&gt;</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span>

<span class="c1"># Preparar estructura del receptor</span>
<span class="err">!</span><span class="n">pymol</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">d</span> <span class="s2">&quot;remove resn HOH;h_add acceptors or donors;save receptor.pdb&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Preparacion-del-ligandos">Preparacion del ligandos<a class="anchor-link" href="#Preparacion-del-ligandos"> </a></h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">grep</span> <span class="o">-</span><span class="n">E</span> <span class="n">HETATM</span><span class="o">.*</span><span class="n">V7G</span> <span class="mi">7</span><span class="n">JKV</span><span class="o">.</span><span class="n">pdb</span> <span class="o">|</span> <span class="n">awk</span> <span class="o">-</span><span class="n">v</span> <span class="n">FS</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="s1">&#39;$22 == &quot;A&quot; {print $0}&#39;</span> <span class="o">&gt;</span> <span class="n">control</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">%%</span><span class="n">bash</span>
<span class="n">cat</span> <span class="o">&gt;</span> <span class="n">ligandos</span><span class="o">.</span><span class="n">smi</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span>
<span class="n">CCCC</span><span class="p">[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">CO</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="nd">@H</span><span class="p">](</span><span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">)</span><span class="n">NC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">OCc1ccccc1</span> <span class="n">Calpeptin</span>
<span class="n">c1ccc</span><span class="p">(</span><span class="n">cc1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="n">c2ccccc2</span><span class="p">)</span><span class="n">S</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CC</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">NO</span> <span class="n">Adrafinil</span>
<span class="n">CCc1cc</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="n">cc1F</span><span class="p">)</span><span class="n">Oc2ccc</span><span class="p">(</span><span class="n">cc2F</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">N</span><span class="p">)</span><span class="n">O</span> <span class="n">MUT056399</span>
<span class="n">CC</span><span class="p">(</span><span class="n">C</span><span class="p">)(</span><span class="n">C</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)[</span><span class="n">C</span><span class="o">@</span><span class="nd">@H</span><span class="p">](</span><span class="n">n1ccnc1</span><span class="p">)</span><span class="n">Oc2ccc</span><span class="p">(</span><span class="n">cc2</span><span class="p">)</span><span class="n">Cl</span> <span class="n">Climbazole</span>
<span class="n">CC1CN</span><span class="p">(</span><span class="n">CCO1</span><span class="p">)</span><span class="n">C</span><span class="p">(</span><span class="o">=</span><span class="n">O</span><span class="p">)</span><span class="n">CN2C</span><span class="o">=</span><span class="n">CC</span><span class="o">=</span><span class="n">N2</span> <span class="n">GRL</span><span class="o">-</span><span class="mi">2420</span>
<span class="n">EOF</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">obabel</span> <span class="n">ligandos</span><span class="o">.</span><span class="n">smi</span> <span class="o">--</span><span class="n">gen3d</span> <span class="n">best</span> <span class="o">-</span><span class="n">O</span> <span class="n">ligandos</span><span class="o">.</span><span class="n">sdf</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Acoplamiento">Acoplamiento<a class="anchor-link" href="#Acoplamiento"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="o">./</span><span class="n">gnina</span> <span class="o">-</span><span class="n">r</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">l</span> <span class="n">ligandos</span><span class="o">.</span><span class="n">sdf</span> <span class="o">--</span><span class="n">autobox_ligand</span> <span class="n">control</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">o</span> <span class="n">gnina_out</span><span class="o">.</span><span class="n">sdf</span> <span class="o">--</span><span class="n">cnn_scoring</span><span class="o">=</span><span class="n">none</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Analisis-de-resultados">Analisis de resultados<a class="anchor-link" href="#Analisis-de-resultados"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">inputfile</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">,</span> <span class="s1">&#39;gnina_out.sdf&#39;</span><span class="p">)]</span>
<span class="n">ligandos</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">inputfile</span><span class="p">:</span>
  <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">title</span> <span class="ow">in</span> <span class="n">ligandos</span><span class="p">:</span>
    <span class="n">ligandos</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">title</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">ligandos</span><span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">title</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="k">for</span> <span class="n">ligando</span> <span class="ow">in</span> <span class="n">ligandos</span><span class="p">:</span>
  <span class="n">f</span> <span class="o">=</span> <span class="n">pybel</span><span class="o">.</span><span class="n">Outputfile</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_out.sdf&#39;</span><span class="o">%</span><span class="n">ligando</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">pose</span> <span class="ow">in</span> <span class="n">ligandos</span><span class="p">[</span><span class="n">ligando</span><span class="p">]:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pose</span><span class="p">)</span>
  <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Visualizacion">Visualizacion<a class="anchor-link" href="#Visualizacion"> </a></h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">confs</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span>  <span class="n">pybel</span><span class="o">.</span><span class="n">readfile</span><span class="p">(</span><span class="s1">&#39;sdf&#39;</span><span class="p">,</span> <span class="s1">&#39;Adrafinil_out.sdf&#39;</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">conf_viewer</span><span class="p">(</span><span class="n">idx</span><span class="p">):</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">confs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">MolTo3DView</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">interact</span><span class="p">(</span><span class="n">conf_viewer</span><span class="p">,</span> <span class="n">idx</span><span class="o">=</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nb">max</span><span class="o">=</span><span class="mi">9</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Calculo-de-interacciones">Calculo de interacciones<a class="anchor-link" href="#Calculo-de-interacciones"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="control">control<a class="anchor-link" href="#control"> </a></h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">grep</span> <span class="s2">&quot;ATOM\|HETATM&quot;</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">echo</span> <span class="n">TER</span> <span class="o">&gt;&gt;</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">grep</span> <span class="n">HETATM</span> <span class="n">control</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;&gt;</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">plip</span> <span class="o">-</span><span class="n">f</span> <span class="n">control_complejo</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">tx</span> <span class="o">--</span><span class="n">name</span> <span class="n">control_interacciones</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="gnina">gnina<a class="anchor-link" href="#gnina"> </a></h4>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">obabel</span> <span class="n">Adrafinil_out</span><span class="o">.</span><span class="n">sdf</span> <span class="o">-</span><span class="n">f1</span> <span class="o">-</span><span class="n">l1</span> <span class="o">-</span><span class="n">O</span> <span class="n">Adrafinil_best</span><span class="o">.</span><span class="n">pdb</span> 

<span class="c1"># Construccion del complejo receptor-ligando</span>
<span class="err">!</span><span class="n">grep</span> <span class="s2">&quot;ATOM\|HETATM&quot;</span> <span class="n">receptor</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;</span> <span class="n">Adrafinil_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">echo</span> <span class="n">TER</span> <span class="o">&gt;&gt;</span> <span class="n">Adrafinil_complejo</span><span class="o">.</span><span class="n">pdb</span>
<span class="err">!</span><span class="n">grep</span> <span class="n">HETATM</span> <span class="n">Adrafinil_best</span><span class="o">.</span><span class="n">pdb</span> <span class="o">&gt;&gt;</span> <span class="n">Adrafinil_complejo</span><span class="o">.</span><span class="n">pdb</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">plip</span> <span class="o">-</span><span class="n">f</span> <span class="n">Adrafinil_complejo</span><span class="o">.</span><span class="n">pdb</span> <span class="o">-</span><span class="n">tx</span> <span class="o">--</span><span class="n">name</span> <span class="n">Adrafinil_interacciones</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">interactions</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">getinteractions</span><span class="p">(</span><span class="s1">&#39;Adrafinil_interacciones.xml&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;restype_lig&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;UNL&#39;</span><span class="p">]</span>
<span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interactions</span><span class="p">]</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;Adrafinil_complejo_protonated.pdb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ifile</span><span class="p">:</span>
    <span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">ifile</span><span class="p">)</span>

<span class="k">for</span> <span class="n">at</span> <span class="ow">in</span> <span class="n">mol</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">at</span><span class="p">[</span><span class="s2">&quot;resid&quot;</span><span class="p">])</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">at</span><span class="p">[</span><span class="s2">&quot;pymol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="k">elif</span> <span class="n">at</span><span class="p">[</span><span class="s2">&quot;resname&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;UNL&#39;</span><span class="p">:</span>
        <span class="n">sel</span> <span class="o">=</span> <span class="n">at</span>
        <span class="n">at</span><span class="p">[</span><span class="s2">&quot;pymol&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;stick&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colorscheme&#39;</span><span class="p">:</span> <span class="s1">&#39;greenCarbon&#39;</span><span class="p">}}</span>

<span class="n">view</span> <span class="o">=</span> <span class="n">py3Dmol</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
<span class="n">view</span><span class="o">.</span><span class="n">addModelsAsFrames</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">at</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mol</span><span class="p">):</span>
  <span class="n">default</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">}}</span>
  <span class="n">view</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;serial&#39;</span><span class="p">:</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">},</span> <span class="n">at</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pymol&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
  <span class="n">view</span><span class="o">.</span><span class="n">setColorByElement</span><span class="p">(</span><span class="n">at</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;pymol&quot;</span><span class="p">,</span> <span class="n">default</span><span class="p">))</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">interactions</span><span class="p">:</span>
  <span class="n">draw_interaction</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
    <span class="n">view</span><span class="o">.</span><span class="n">addLabel</span><span class="p">(</span><span class="n">label</span><span class="p">(</span><span class="n">i</span><span class="p">),</span>
                  <span class="p">{</span><span class="s1">&#39;fontSize&#39;</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span>
                   <span class="s1">&#39;position&#39;</span><span class="p">:</span>
                   <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;protcoo&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]},</span>
                   <span class="s1">&#39;screenOffset&#39;</span><span class="p">:{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}})</span>
    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;resnr&#39;</span><span class="p">])</span>
<span class="n">view</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">({</span><span class="s1">&#39;model&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;resn&#39;</span><span class="p">:</span> <span class="s1">&#39;UNL&#39;</span><span class="p">})</span>
<span class="n">view</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">cut</span> <span class="o">-</span><span class="n">d</span><span class="s1">&#39; &#39;</span> <span class="o">-</span><span class="n">f2</span> <span class="n">ligandos</span><span class="o">.</span><span class="n">smi</span> <span class="o">&gt;</span> <span class="n">lista</span>
<span class="err">!</span><span class="n">bash</span> <span class="n">calcular_interacciones</span><span class="o">.</span><span class="n">sh</span> <span class="n">lista</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="err">!</span><span class="n">ls</span> <span class="o">*</span><span class="n">pdb</span><span class="o">.</span><span class="n">xml</span> <span class="o">&gt;</span> <span class="n">lista_xml</span><span class="o">.</span><span class="n">txt</span>
<span class="err">!</span><span class="n">python3</span> <span class="n">reports2csv</span><span class="o">.</span><span class="n">py</span> <span class="n">lista_xml</span><span class="o">.</span><span class="n">txt</span> <span class="n">interacciones</span><span class="o">.</span><span class="n">csv</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/lowhaningmolecules/2021/06/21/docking.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/lowhaningmolecules/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/lowhaningmolecules/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/lowhaningmolecules/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/fastai" title="fastai"><svg class="svg-icon grey"><use xlink:href="/lowhaningmolecules/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/fastdotai" title="fastdotai"><svg class="svg-icon grey"><use xlink:href="/lowhaningmolecules/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
